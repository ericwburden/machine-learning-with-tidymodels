<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Multiple Linear Regression | Machine Learning with TidyModels</title>
  <meta name="description" content="This is a primer on various ML modeling techniques and the tidymodels</code>
syntax and workflow for leveraging these techniques.</p>" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Multiple Linear Regression | Machine Learning with TidyModels" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a primer on various ML modeling techniques and the tidymodels</code>
syntax and workflow for leveraging these techniques.</p>" />
  <meta name="github-repo" content="ericwburden/machine-learning-with-tidymodels" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Multiple Linear Regression | Machine Learning with TidyModels" />
  
  <meta name="twitter:description" content="This is a primer on various ML modeling techniques and the tidymodels</code>
syntax and workflow for leveraging these techniques.</p>" />
  

<meta name="author" content="Eric Burden" />


<meta name="date" content="2022-11-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-3.html"/>
<link rel="next" href="chapter-5.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes on Tidymodels</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#ch1-software_used"><i class="fa fa-check"></i><b>1.1</b> Software Used</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter-2.html"><a href="chapter-2.html"><i class="fa fa-check"></i><b>2</b> The Tidymodels Workflow</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter-2.html"><a href="chapter-2.html#ch2-about-tidymodels"><i class="fa fa-check"></i><b>2.1</b> About Tidymodels</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter-2.html"><a href="chapter-2.html#ch2-reuse-existing-data-structures"><i class="fa fa-check"></i><b>2.1.1</b> Re-use existing data structures</a></li>
<li class="chapter" data-level="2.1.2" data-path="chapter-2.html"><a href="chapter-2.html#ch2-simple-functions-with-pipes"><i class="fa fa-check"></i><b>2.1.2</b> Compose simple functions with pipes</a></li>
<li class="chapter" data-level="2.1.3" data-path="chapter-2.html"><a href="chapter-2.html#ch2-embrace-functional-programming"><i class="fa fa-check"></i><b>2.1.3</b> Embrace functional programming</a></li>
<li class="chapter" data-level="2.1.4" data-path="chapter-2.html"><a href="chapter-2.html#ch2-design-for-humans"><i class="fa fa-check"></i><b>2.1.4</b> Design for humans</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter-2.html"><a href="chapter-2.html#ch2-philosophy-in-practice"><i class="fa fa-check"></i><b>2.2</b> Philosophy in Practice</a></li>
<li class="chapter" data-level="2.3" data-path="chapter-2.html"><a href="chapter-2.html#ch2-workflow-steps"><i class="fa fa-check"></i><b>2.3</b> Workflow Steps</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="chapter-2.html"><a href="chapter-2.html#ch2-data-splitting"><i class="fa fa-check"></i><b>2.3.1</b> Data Splitting</a></li>
<li class="chapter" data-level="2.3.2" data-path="chapter-2.html"><a href="chapter-2.html#ch2-data-preparation"><i class="fa fa-check"></i><b>2.3.2</b> Data Preparation</a></li>
<li class="chapter" data-level="2.3.3" data-path="chapter-2.html"><a href="chapter-2.html#ch2-model-specification"><i class="fa fa-check"></i><b>2.3.3</b> Model Specification</a></li>
<li class="chapter" data-level="2.3.4" data-path="chapter-2.html"><a href="chapter-2.html#ch2-bundling-a-workflow"><i class="fa fa-check"></i><b>2.3.4</b> Bundling a Workflow</a></li>
<li class="chapter" data-level="2.3.5" data-path="chapter-2.html"><a href="chapter-2.html#ch2-checking-results"><i class="fa fa-check"></i><b>2.3.5</b> Checking Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-3.html"><a href="chapter-3.html"><i class="fa fa-check"></i><b>3</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter-3.html"><a href="chapter-3.html#ch3-description"><i class="fa fa-check"></i><b>3.1</b> Description</a></li>
<li class="chapter" data-level="3.2" data-path="chapter-3.html"><a href="chapter-3.html#ch3-how-it-works"><i class="fa fa-check"></i><b>3.2</b> How it Works</a></li>
<li class="chapter" data-level="3.3" data-path="chapter-3.html"><a href="chapter-3.html#ch3-evaluating-validity"><i class="fa fa-check"></i><b>3.3</b> Evaluating Validity</a></li>
<li class="chapter" data-level="3.4" data-path="chapter-3.html"><a href="chapter-3.html#ch3-evaluating-fit"><i class="fa fa-check"></i><b>3.4</b> Evaluating Fit</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="chapter-3.html"><a href="chapter-3.html#ch3-residual-standard-error"><i class="fa fa-check"></i><b>3.4.1</b> Residual Standard Error</a></li>
<li class="chapter" data-level="3.4.2" data-path="chapter-3.html"><a href="chapter-3.html#ch3-rsq-statistic"><i class="fa fa-check"></i><b>3.4.2</b> <span class="math inline">\(R^2\)</span> Statistic</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="chapter-3.html"><a href="chapter-3.html#ch3-example"><i class="fa fa-check"></i><b>3.5</b> Example</a></li>
<li class="chapter" data-level="3.6" data-path="chapter-3.html"><a href="chapter-3.html#ch3-considerations"><i class="fa fa-check"></i><b>3.6</b> Considerations</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="chapter-3.html"><a href="chapter-3.html#ch3-limits-of-applicability"><i class="fa fa-check"></i><b>3.6.1</b> Limits of Applicability</a></li>
<li class="chapter" data-level="3.6.2" data-path="chapter-3.html"><a href="chapter-3.html#ch3-outliers"><i class="fa fa-check"></i><b>3.6.2</b> Outliers</a></li>
<li class="chapter" data-level="3.6.3" data-path="chapter-3.html"><a href="chapter-3.html#ch3-high-leverage-points"><i class="fa fa-check"></i><b>3.6.3</b> High-leverage points</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter-4.html"><a href="chapter-4.html"><i class="fa fa-check"></i><b>4</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter-4.html"><a href="chapter-4.html#ch4-description"><i class="fa fa-check"></i><b>4.1</b> Description</a></li>
<li class="chapter" data-level="4.2" data-path="chapter-4.html"><a href="chapter-4.html#ch4-how-it-works"><i class="fa fa-check"></i><b>4.2</b> How it Works</a></li>
<li class="chapter" data-level="4.3" data-path="chapter-4.html"><a href="chapter-4.html#ch4-evaluating-validity"><i class="fa fa-check"></i><b>4.3</b> Evaluating Validity</a></li>
<li class="chapter" data-level="4.4" data-path="chapter-4.html"><a href="chapter-4.html#ch4-identifying-important-predictors"><i class="fa fa-check"></i><b>4.4</b> Identifying Important Predictors</a></li>
<li class="chapter" data-level="4.5" data-path="chapter-4.html"><a href="chapter-4.html#ch4-evaluating-fit"><i class="fa fa-check"></i><b>4.5</b> Evaluating Fit</a></li>
<li class="chapter" data-level="4.6" data-path="chapter-4.html"><a href="chapter-4.html#ch4-example"><i class="fa fa-check"></i><b>4.6</b> Example</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="chapter-4.html"><a href="chapter-4.html#ch-correlated-predictors"><i class="fa fa-check"></i><b>4.6.1</b> Correlated Predictors</a></li>
<li class="chapter" data-level="4.6.2" data-path="chapter-4.html"><a href="chapter-4.html#ch4-tidymodels-workflow"><i class="fa fa-check"></i><b>4.6.2</b> Tidymodels Workflow</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="chapter-4.html"><a href="chapter-4.html#ch4-considerations"><i class="fa fa-check"></i><b>4.7</b> Considerations</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="chapter-4.html"><a href="chapter-4.html#ch4-not-just-combining-simple-models"><i class="fa fa-check"></i><b>4.7.1</b> Not Just Combining Simple Models</a></li>
<li class="chapter" data-level="4.7.2" data-path="chapter-4.html"><a href="chapter-4.html#ch4-qualitative-variables"><i class="fa fa-check"></i><b>4.7.2</b> Qualitative Variables</a></li>
<li class="chapter" data-level="4.7.3" data-path="chapter-4.html"><a href="chapter-4.html#ch4-predictor-interactions"><i class="fa fa-check"></i><b>4.7.3</b> Predictor Interactions</a></li>
<li class="chapter" data-level="4.7.4" data-path="chapter-4.html"><a href="chapter-4.html#ch4-polynomial-regression"><i class="fa fa-check"></i><b>4.7.4</b> Polynomial Regression</a></li>
<li class="chapter" data-level="4.7.5" data-path="chapter-4.html"><a href="chapter-4.html#ch4-potential-issues"><i class="fa fa-check"></i><b>4.7.5</b> Potential Issues</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter-5.html"><a href="chapter-5.html"><i class="fa fa-check"></i><b>5</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter-5.html"><a href="chapter-5.html#ch5-description"><i class="fa fa-check"></i><b>5.1</b> Description</a></li>
<li class="chapter" data-level="5.2" data-path="chapter-5.html"><a href="chapter-5.html#ch5-how-it-works"><i class="fa fa-check"></i><b>5.2</b> How it Works</a></li>
<li class="chapter" data-level="5.3" data-path="chapter-5.html"><a href="chapter-5.html#ch5-evaluating-validity"><i class="fa fa-check"></i><b>5.3</b> Evaluating Validity</a></li>
<li class="chapter" data-level="5.4" data-path="chapter-5.html"><a href="chapter-5.html#ch5-evaluating-fit"><i class="fa fa-check"></i><b>5.4</b> Evaluating Fit</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="chapter-5.html"><a href="chapter-5.html#ch5-binomial-logistic-regression"><i class="fa fa-check"></i><b>5.4.1</b> Binomial Logistic Regression</a></li>
<li class="chapter" data-level="5.4.2" data-path="chapter-5.html"><a href="chapter-5.html#ch5-multinomial-logistic-regression"><i class="fa fa-check"></i><b>5.4.2</b> Multinomial Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="chapter-5.html"><a href="chapter-5.html#ch5-example"><i class="fa fa-check"></i><b>5.5</b> Example</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="chapter-5.html"><a href="chapter-5.html#dataset"><i class="fa fa-check"></i><b>5.5.1</b> Dataset</a></li>
<li class="chapter" data-level="5.5.2" data-path="chapter-5.html"><a href="chapter-5.html#response-categories"><i class="fa fa-check"></i><b>5.5.2</b> Response Categories</a></li>
<li class="chapter" data-level="5.5.3" data-path="chapter-5.html"><a href="chapter-5.html#correlations"><i class="fa fa-check"></i><b>5.5.3</b> Correlations</a></li>
<li class="chapter" data-level="5.5.4" data-path="chapter-5.html"><a href="chapter-5.html#high-leverage-points"><i class="fa fa-check"></i><b>5.5.4</b> High Leverage Points</a></li>
<li class="chapter" data-level="5.5.5" data-path="chapter-5.html"><a href="chapter-5.html#fit-and-check"><i class="fa fa-check"></i><b>5.5.5</b> Fit and Check</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>6</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Machine Learning with TidyModels</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-4" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Multiple Linear Regression<a href="chapter-4.html#chapter-4" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="ch4-description" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Description<a href="chapter-4.html#ch4-description" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An approach for predicting a dependent (response) value <span class="math inline">\(Y\)</span> based on multiple
independent (predictor) values <span class="math inline">\(X_1, X_2, X_3, ..., X_n\)</span>, given that there is some
proportional linear relationship between the predictor values and the response value.
That is, assuming that one unit of change in any predictor value results in a consistent
change (increase or decrease) in the response value.</p>
<p><span class="math display">\[ Y \approx \beta_0 + \beta_1X_1 + \beta_2X_2 + ... + \beta_nX_n + \epsilon\]</span></p>
<p>In this equation, just like for simple linear regression, <span class="math inline">\(\beta_0\)</span> represents a
constant offset (the <em>intercept</em>) and <span class="math inline">\(\beta_i\)</span> represents the average amount <span class="math inline">\(Y\)</span>
changes for each change in <span class="math inline">\(X_i\)</span> (the <em>slope</em> for that predictor) while holding all
other predictor variables fixed.</p>
</div>
<div id="ch4-how-it-works" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> How it Works<a href="chapter-4.html#ch4-how-it-works" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Multiple Linear Regression behaves similarly to Simple Linear Regression, with the
exception that instead of representing the fit via a 2-dimensional line, the
dimensionality of the fit is one greater than the number of predictors. For example, the
two-predictor case can be represented as a plane through a three-dimensional grid with
<span class="math inline">\(Y\)</span>, <span class="math inline">\(X_1\)</span>, and <span class="math inline">\(X_2\)</span> axes. The slopes and intercept for a multi-dimensional fit can be
calculated similar to the Simple Linear model, but the math is apparently gnarly enough
that ISLR declined to include it.</p>
</div>
<div id="ch4-evaluating-validity" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Evaluating Validity<a href="chapter-4.html#ch4-evaluating-validity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Instead of the <em>t-statistic</em> or <em>p-value</em>, the applicability of a Multiple Linear
Regression model can be evaluated using the <em>F-statistic</em>, which can be calculated for
<em>n</em> observations and <em>p</em> predictors as:</p>
<p><span class="math display">\[
\begin{align}
RSS &amp; = \sum_{i=1}^n{(y_i - \hat{y}_i)^2} \\
    &amp; = \sum_{i=1}^2{(y_1 - \beta_0 - \beta_1X_1 - \beta_2X_2 - \ ... \ - \beta_nX_n)} \\
TSS &amp; = \sum_{i=1}^n{(y_i - \bar{y})^2} \\
F &amp; = \frac{(TSS - RSS)/p}{RSS/(n - p - 1)}
\end{align}
\]</span></p>
<p>If the assumptions of a linear model are correct, then:</p>
<p><span class="math display">\[E\{RSS/(n - p - 1)\} = \sigma^2\]</span></p>
<p>If the null hypothesis is true, that is all the slopes of the model are 0, then:</p>
<p><span class="math display">\[E\{(TSS - RSS)/p\} = \sigma^2\]</span></p>
<p>So, if there is no relationship between the response and predictors, we would expect the
<em>F-statistic</em> to be near 1, since <span class="math inline">\(\frac{\sigma^2}{\sigma^2} = 1\)</span>. On the other hand, if
there is some relationship between the response and predictors, we expect the numerator
of the <em>F-statistic</em> to be greater than <span class="math inline">\(\sigma^2\)</span>, making <span class="math inline">\(F\)</span> greater than 1. How large
<span class="math inline">\(F\)</span> needs to be to indicate the applicability of the model is dependent on the size of
<em>n</em> and <em>p</em>. When the number of observations is large, then a smaller <span class="math inline">\(F\)</span> can indicate
the relationship. The <em>p-value</em> can be calculated from <span class="math inline">\(F\)</span> for a given <em>n</em> and <em>p</em>, as
well as for each predictor variable. These values are reported by the base R <code>lm</code> model,
which can handle multiple linear regression. The code looks like:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="chapter-4.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1337</span>)</span>
<span id="cb31-2"><a href="chapter-4.html#cb31-2" aria-hidden="true" tabindex="-1"></a>x1  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>)</span>
<span id="cb31-3"><a href="chapter-4.html#cb31-3" aria-hidden="true" tabindex="-1"></a>x2  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">17</span>, <span class="dv">23</span>, <span class="dv">29</span>, <span class="dv">31</span>)</span>
<span id="cb31-4"><a href="chapter-4.html#cb31-4" aria-hidden="true" tabindex="-1"></a>y   <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="fl">0.33</span><span class="sc">*</span>x2 <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">10</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)</span>
<span id="cb31-5"><a href="chapter-4.html#cb31-5" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2)</span>
<span id="cb31-6"><a href="chapter-4.html#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="chapter-4.html#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1 + x2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.39015 -0.10268 -0.04461  0.09799  0.51006 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  4.85564    0.29322  16.560 7.15e-07 ***
## x1           2.08968    0.15838  13.194 3.36e-06 ***
## x2           0.29789    0.04474   6.659 0.000288 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2669 on 7 degrees of freedom
## Multiple R-squared:  0.9994, Adjusted R-squared:  0.9992 
## F-statistic:  5681 on 2 and 7 DF,  p-value: 5.79e-12</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="chapter-4.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb33-2"><a href="chapter-4.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ x1 + x2)</span></span>
<span id="cb33-3"><a href="chapter-4.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-4"><a href="chapter-4.html#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb33-5"><a href="chapter-4.html#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max</span></span>
<span id="cb33-6"><a href="chapter-4.html#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -0.39015 -0.10268 -0.04461  0.09799  0.51006</span></span>
<span id="cb33-7"><a href="chapter-4.html#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;</span></span>
<span id="cb33-8"><a href="chapter-4.html#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb33-9"><a href="chapter-4.html#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb33-10"><a href="chapter-4.html#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  4.85564    0.29322  16.560 7.15e-07 ***</span></span>
<span id="cb33-11"><a href="chapter-4.html#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x1           2.08968    0.15838  13.194 3.36e-06 ***</span></span>
<span id="cb33-12"><a href="chapter-4.html#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x2           0.29789    0.04474   6.659 0.000288 ***</span></span>
<span id="cb33-13"><a href="chapter-4.html#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb33-14"><a href="chapter-4.html#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb33-15"><a href="chapter-4.html#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;</span></span>
<span id="cb33-16"><a href="chapter-4.html#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.2669 on 7 degrees of freedom</span></span>
<span id="cb33-17"><a href="chapter-4.html#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.9994,    Adjusted R-squared:  0.9992</span></span>
<span id="cb33-18"><a href="chapter-4.html#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic:  5681 on 2 and 7 DF,  p-value: 5.79e-12</span></span></code></pre></div>
<p>Here we see a larger <em>p-value</em> for <code>x1</code> compared to <code>x2</code>, which makes sense given that
the slope for <code>x2</code> is smaller. The overall <code>p-value</code> is also quite small and <span class="math inline">\(F\)</span> is
quite large, indicating that the response and predictors do have a relationship. Compare
that to:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="chapter-4.html#cb34-1" aria-hidden="true" tabindex="-1"></a>y   <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">40</span>) <span class="co"># random values</span></span>
<span id="cb34-2"><a href="chapter-4.html#cb34-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2)</span>
<span id="cb34-3"><a href="chapter-4.html#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1 + x2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -19.8573  -8.3492   0.6098  11.5581  19.5387 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)   45.729     17.386   2.630   0.0339 *
## x1            -7.257      9.391  -0.773   0.4649  
## x2             1.437      2.653   0.542   0.6048  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 15.82 on 7 degrees of freedom
## Multiple R-squared:   0.22,  Adjusted R-squared:  -0.002895 
## F-statistic: 0.987 on 2 and 7 DF,  p-value: 0.4192</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="chapter-4.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb36-2"><a href="chapter-4.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ x1 + x2)</span></span>
<span id="cb36-3"><a href="chapter-4.html#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;</span></span>
<span id="cb36-4"><a href="chapter-4.html#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb36-5"><a href="chapter-4.html#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max</span></span>
<span id="cb36-6"><a href="chapter-4.html#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -19.8573  -8.3492   0.6098  11.5581  19.5387</span></span>
<span id="cb36-7"><a href="chapter-4.html#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;</span></span>
<span id="cb36-8"><a href="chapter-4.html#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb36-9"><a href="chapter-4.html#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb36-10"><a href="chapter-4.html#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   45.729     17.386   2.630   0.0339 *</span></span>
<span id="cb36-11"><a href="chapter-4.html#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x1            -7.257      9.391  -0.773   0.4649</span></span>
<span id="cb36-12"><a href="chapter-4.html#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x2             1.437      2.653   0.542   0.6048</span></span>
<span id="cb36-13"><a href="chapter-4.html#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb36-14"><a href="chapter-4.html#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb36-15"><a href="chapter-4.html#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb36-16"><a href="chapter-4.html#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 15.82 on 7 degrees of freedom</span></span>
<span id="cb36-17"><a href="chapter-4.html#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:   0.22,     Adjusted R-squared:  -0.002895</span></span>
<span id="cb36-18"><a href="chapter-4.html#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 0.987 on 2 and 7 DF,  p-value: 0.4192</span></span></code></pre></div>
<p>Here, the overall <em>p-value</em> is rather large, and <span class="math inline">\(F\)</span> is very nearly 1, indicating (as we
suspect) that <code>y</code> cannot be predicted by <code>x1</code> and <code>x2</code>.</p>
</div>
<div id="ch4-identifying-important-predictors" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Identifying Important Predictors<a href="chapter-4.html#ch4-identifying-important-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Even after determining that a <em>group</em> of predictors can accurately (to some degree) be
used to model the behavior of the response value, it is entirely possible (even likely)
that some predictors are more influential than others. Some predictors may even be
superfluous. By removing predictors whose explanatory power is weak, the model can be
refined and the model interpretation can be sharpened. For example, if we determine that
weight, horsepower, and engine displacement all affect the MPG we can expect from a
vehicle, and we want to improve fuel efficiency, then in the real world it is beneficial
to determine which inputs have the biggest impact on the output so that we can focus our
attention on those significant inputs. One can start by examining the individual
<em>p-values</em> reported by the model, but recall that these <em>p-values</em> where calculated when
<em>all</em> predictors were modeled. Adding or removing predictors may change the <em>p-values</em>
for any or all of the remaining predictors (perhaps there are interaction effects not
accounted for). One can imagine several strategies for selecting predictors, however,
this approach is not recommended (or supported) in <code>tidymodels</code>. Instead, various
<em>regularization</em> approaches are provided which <em>penalize</em> (or reduce the contributions
of) less important variables. These methods will be covered in more detail in a later
chapter.</p>
</div>
<div id="ch4-evaluating-fit" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Evaluating Fit<a href="chapter-4.html#ch4-evaluating-fit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>RSE and <span class="math inline">\(R^2\)</span> can be computed and interpreted the same as for Simple Linear models . For
Multiple Linear Regression, <span class="math inline">\(R^2\)</span> equals <span class="math inline">\(Cor(Y,\hat{Y})^2\)</span>, which is the square of the
correlation between the response variable and the predicted response variable. It is
important to note that adding more predictor variables to the model will <em>always</em>
increase <span class="math inline">\(R^2\)</span>, even if those predictor variables are only weakly associated with the
response. This is due to <em>over-fitting</em>. Care should be taken when adding additional
predictor variables to the model to ensure that each is substantially contributing to
the fit. This can be assessed by observing the effect on RSE and <span class="math inline">\(R^2\)</span> of adding or
removing a particular predictor. If the impact is minimal, that predictor is likely
unnecessary. RSE in particular can help evaluate this, as the RSE can <em>increase</em>
slightly if the additional predictor variables only have a small impact on RSS (residual
sum of squares).</p>
</div>
<div id="ch4-example" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Example<a href="chapter-4.html#ch4-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we have an underpinning for the way multiple predictor variables impact the
linear regression approach, we can explore the <code>tidymodels</code> workflow for this approach.
We can add <em>exploratory data analysis</em> steps to suss out any complicating issues
(discussed in <a href="chapter-4.html#ch4-considerations">Considerations</a>).</p>
<div id="ch-correlated-predictors" class="section level3 hasAnchor" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Correlated Predictors<a href="chapter-4.html#ch-correlated-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="chapter-4.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a scatterplot matrix to identify correlations</span></span>
<span id="cb37-2"><a href="chapter-4.html#cb37-2" aria-hidden="true" tabindex="-1"></a>GGally<span class="sc">::</span><span class="fu">ggpairs</span>(mtcars, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">&quot;disp&quot;</span>, <span class="st">&quot;hp&quot;</span>, <span class="st">&quot;drat&quot;</span>, <span class="st">&quot;wt&quot;</span>, <span class="st">&quot;qsec&quot;</span>), <span class="at">progress =</span> F)</span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-3-1.png" width="672" /></p>
<p>In this <em>scatterplot matrix</em>, the bottom half of the plot shows scatterplots for each
row/column combination, the top half includes the raw correlations and their
significance (more asterisks == more correlation), and the central diagonal indicates a
histogram of the relevant variable. We can see from this plot that there are some major
predictor correlations here that we can account for in our model fit. Note also the
left-biased histograms for <code>disp</code> and <code>hp</code>. This can generally be detrimental to the
model fit and can be improved by log-transforming the predictor variable. This will be
shown below.</p>
</div>
<div id="ch4-tidymodels-workflow" class="section level3 hasAnchor" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Tidymodels Workflow<a href="chapter-4.html#ch4-tidymodels-workflow" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="chapter-4.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb38-2"><a href="chapter-4.html#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="chapter-4.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Note, we&#39;re still not splitting the dataset here, for the sake of</span></span>
<span id="cb38-4"><a href="chapter-4.html#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># comparison to the Simple Linear Regression example.</span></span>
<span id="cb38-5"><a href="chapter-4.html#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="chapter-4.html#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-process the data using a recipe</span></span>
<span id="cb38-7"><a href="chapter-4.html#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Note, this is slightly different than the example from Chapter 2,</span></span>
<span id="cb38-8"><a href="chapter-4.html#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># here we add interaction terms for the many interactions observed.</span></span>
<span id="cb38-9"><a href="chapter-4.html#cb38-9" aria-hidden="true" tabindex="-1"></a>(multiple_linear_regression_recipe</span>
<span id="cb38-10"><a href="chapter-4.html#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="ot">&lt;-</span> <span class="fu">recipe</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> drat <span class="sc">+</span> wt <span class="sc">+</span> qsec, </span>
<span id="cb38-11"><a href="chapter-4.html#cb38-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> mtcars)</span>
<span id="cb38-12"><a href="chapter-4.html#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">step_log</span>(disp, hp)</span>
<span id="cb38-13"><a href="chapter-4.html#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">step_interact</span>(</span>
<span id="cb38-14"><a href="chapter-4.html#cb38-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">terms =</span> <span class="sc">~</span> disp<span class="sc">:</span>hp <span class="sc">+</span> </span>
<span id="cb38-15"><a href="chapter-4.html#cb38-15" aria-hidden="true" tabindex="-1"></a>              disp<span class="sc">:</span>drat <span class="sc">+</span> </span>
<span id="cb38-16"><a href="chapter-4.html#cb38-16" aria-hidden="true" tabindex="-1"></a>              disp<span class="sc">:</span>wt <span class="sc">+</span> </span>
<span id="cb38-17"><a href="chapter-4.html#cb38-17" aria-hidden="true" tabindex="-1"></a>              hp<span class="sc">:</span>wt <span class="sc">+</span> </span>
<span id="cb38-18"><a href="chapter-4.html#cb38-18" aria-hidden="true" tabindex="-1"></a>              hp<span class="sc">:</span>qsec <span class="sc">+</span> </span>
<span id="cb38-19"><a href="chapter-4.html#cb38-19" aria-hidden="true" tabindex="-1"></a>              drat<span class="sc">:</span>wt)</span>
<span id="cb38-20"><a href="chapter-4.html#cb38-20" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Recipe
## 
## Inputs:
## 
##       role #variables
##    outcome          1
##  predictor          5
## 
## Operations:
## 
## Log transformation on disp, hp
## Interactions with disp:hp + disp:drat + disp:wt + hp:wt + hp:qsec + drat:wt</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="chapter-4.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup up the model</span></span>
<span id="cb40-2"><a href="chapter-4.html#cb40-2" aria-hidden="true" tabindex="-1"></a>(multiple_linear_regression_model</span>
<span id="cb40-3"><a href="chapter-4.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>()</span>
<span id="cb40-4"><a href="chapter-4.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">set_engine</span>(<span class="st">&quot;lm&quot;</span>)</span>
<span id="cb40-5"><a href="chapter-4.html#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>))</span></code></pre></div>
<pre><code>## Linear Regression Model Specification (regression)
## 
## Computational engine: lm</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="chapter-4.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bundle the recipe and model into a workflow, fit the model</span></span>
<span id="cb42-2"><a href="chapter-4.html#cb42-2" aria-hidden="true" tabindex="-1"></a>(multiple_linear_regression_workflow</span>
<span id="cb42-3"><a href="chapter-4.html#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="ot">&lt;-</span> <span class="fu">workflow</span>()</span>
<span id="cb42-4"><a href="chapter-4.html#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">add_recipe</span>(multiple_linear_regression_recipe)</span>
<span id="cb42-5"><a href="chapter-4.html#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">add_model</span>(multiple_linear_regression_model)</span>
<span id="cb42-6"><a href="chapter-4.html#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">fit</span>(<span class="at">data =</span> <span class="fu">training</span>(mtcars_split)))</span></code></pre></div>
<pre><code>## ══ Workflow [trained] ═══════════════════════════════════════════════════════════════════════════════
## Preprocessor: Recipe
## Model: linear_reg()
## 
## ── Preprocessor ─────────────────────────────────────────────────────────────────────────────────────
## 2 Recipe Steps
## 
## • step_log()
## • step_interact()
## 
## ── Model ────────────────────────────────────────────────────────────────────────────────────────────
## 
## Call:
## stats::lm(formula = ..y ~ ., data = data)
## 
## Coefficients:
## (Intercept)         disp           hp         drat           wt         qsec    disp_x_hp  
##      9.8223      -5.0773       9.2242      21.5371     -26.5927       1.5736       1.9581  
## disp_x_drat    disp_x_wt      hp_x_wt    hp_x_qsec    drat_x_wt  
##     -6.8414       6.9204      -6.4707      -0.2865       5.1099</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="chapter-4.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add predictions to training data</span></span>
<span id="cb44-2"><a href="chapter-4.html#cb44-2" aria-hidden="true" tabindex="-1"></a>multiple_linear_regression_predictions <span class="ot">&lt;-</span> <span class="fu">augment</span>(</span>
<span id="cb44-3"><a href="chapter-4.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  multiple_linear_regression_workflow, </span>
<span id="cb44-4"><a href="chapter-4.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  mtcars</span>
<span id="cb44-5"><a href="chapter-4.html#cb44-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-6"><a href="chapter-4.html#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="chapter-4.html#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check performance</span></span>
<span id="cb44-8"><a href="chapter-4.html#cb44-8" aria-hidden="true" tabindex="-1"></a>(<span class="fu">metrics</span>(multiple_linear_regression_predictions, mpg, .pred))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 rmse    standard       1.91 
## 2 rsq     standard       0.899
## 3 mae     standard       1.54</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="chapter-4.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># It is often helpful to visualze results like this, comparing the </span></span>
<span id="cb46-2"><a href="chapter-4.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># actual values to the predicted values of the response variable.</span></span>
<span id="cb46-3"><a href="chapter-4.html#cb46-3" aria-hidden="true" tabindex="-1"></a>(multiple_linear_regression_predictions</span>
<span id="cb46-4"><a href="chapter-4.html#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .pred, <span class="at">y =</span> mpg))</span>
<span id="cb46-5"><a href="chapter-4.html#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb46-6"><a href="chapter-4.html#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb46-7"><a href="chapter-4.html#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Multiple Linear Regression&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Predicted&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Actual&quot;</span>)</span>
<span id="cb46-8"><a href="chapter-4.html#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span>  <span class="fu">theme_minimal</span>())</span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-4-1.png" width="672" /></p>
<p>Looking at the performance metrics, we can see that the estimated fit of the multiple
linear regression has a better estimated <span class="math inline">\(R^2\)</span> than the simple linear regression model
from <a href="chapter-3.html#ch3-example">Chapter 3</a>. We shouldn’t be too overconfident here, though, adding
additional variables <em>always</em> increases <span class="math inline">\(R^2\)</span>. The visualization reveals a good fit, as
well. For real data, this test of performance would be conducted against a <em>testing</em>
set, which we will see in future examples.</p>
</div>
</div>
<div id="ch4-considerations" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Considerations<a href="chapter-4.html#ch4-considerations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="ch4-not-just-combining-simple-models" class="section level3 hasAnchor" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> Not Just Combining Simple Models<a href="chapter-4.html#ch4-not-just-combining-simple-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When multiple predictor values are present, the Multiple Linear Regression model is
vastly preferred over combining or averaging multiple Simple Linear Regression fits, as
the Multiple Linear Regression may reveal interaction effects that will be masked by
multiple Simple Linear Regression fits. This makes intuitive sense, as we can imagine
real-life scenarios in which correlated observations are not necessarily related
directly, but may have a single cause (i.e., increased ice cream sales do not <em>cause</em> an
increase in shark attacks).</p>
</div>
<div id="ch4-qualitative-variables" class="section level3 hasAnchor" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> Qualitative Variables<a href="chapter-4.html#ch4-qualitative-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Qualitative predictor variables (aka categories, or factors) can be used as predictor
variables as well, they simple need to be converted into quantitative <em>dummy</em> variables,
where presence or absence of a category is denoted by a <code>1</code> or <code>0</code> in the column,
respectively. In practice, this process is handled by R’s <em>formula</em> syntax and is not
something that must be considered, beyond ensuring that qualitative variables are
encoded as <em>factors</em> and not <em>strings</em>.</p>
</div>
<div id="ch4-predictor-interactions" class="section level3 hasAnchor" number="4.7.3">
<h3><span class="header-section-number">4.7.3</span> Predictor Interactions<a href="chapter-4.html#ch4-predictor-interactions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is possible that each unit change in one predictor variable can impact not just the
response variable but also the <em>slope</em> for another predictor variable. An example is the
number of tools and the number of workers on the rate of production in some factory
setting. It seems clear that both input variables are connected in some way, since an
abundance of workers with very few pieces of equipment would produce a totally different
output than a moderate number of both. These interaction effects can be accounted for by
adding an interaction column to the data set (multiplying the two values together) or by
adding interaction terms to the formula specification in R. For example,
<code>units ~ workers + equipment + workers:equipment</code>,
<code>units ~ workers + equipment + workers*equipment</code>, and <code>units ~ workers*equipment</code> are
all equivalent and different spellings of the formula that includes contributions by
<code>workers</code>, <code>equipment</code>, and the interaction between the two.</p>
</div>
<div id="ch4-polynomial-regression" class="section level3 hasAnchor" number="4.7.4">
<h3><span class="header-section-number">4.7.4</span> Polynomial Regression<a href="chapter-4.html#ch4-polynomial-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are times when the relationship between a predictor and response is not a straight
line, but can be described by a curve. In these cases, <em>polynomial regression</em> can be
employed. One strategy to deal with this is to include powers of the predictor variables
as additional predictors. For example, using the <code>mtcars</code> data set, it may be that <code>mpg</code>
and <code>horsepower</code> have a <em>quadratic</em> relationship. This could be modeled by
<span class="math display">\[mpg = \beta_0 + (\beta_1 \times horsepower) + (\beta_2 \times horsepower^2) + \epsilon\]</span>
Where the square of <code>horsepower</code> is included as a predictor. This allows for the same
linear regression to fit a curved line. The user should be careful to not over-use
polynomials, however, as this is a potential source of over-fitting.</p>
</div>
<div id="ch4-potential-issues" class="section level3 hasAnchor" number="4.7.5">
<h3><span class="header-section-number">4.7.5</span> Potential Issues<a href="chapter-4.html#ch4-potential-issues" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="ch4-nonlinearity-of-relationships" class="section level4 hasAnchor" number="4.7.5.1">
<h4><span class="header-section-number">4.7.5.1</span> Non-linearity of response-predictor relationships<a href="chapter-4.html#ch4-nonlinearity-of-relationships" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If the relationship between the response and predictors is truly not linear, then a
linear regression model cannot be properly fit to the data. This issue can be diagnosed
using a residual plot. When plotting the residuals vs the predicted response values,
there should be no discernible pattern. If there <em>is</em> an observable pattern, then it
indicates a systematic mis-fit of the model to the response. At times, this can be
corrected by applying non-linear transformations to predictors such as <span class="math inline">\(\log{X}\)</span>,
<span class="math inline">\(\sqrt{X}\)</span>, or <span class="math inline">\(X^2\)</span>.</p>
</div>
<div id="ch4-correlation-of-error-terms" class="section level4 hasAnchor" number="4.7.5.2">
<h4><span class="header-section-number">4.7.5.2</span> Correlation of error terms<a href="chapter-4.html#ch4-correlation-of-error-terms" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Linear regression models assume that the error inherent in each measurement is
independent. If this assumption is violated, then the model may overestimate the
calculated confidence interval (i.e., indicate narrower confidence and prediction
intervals than would reflect reality). This can easily occur with time series data,
where sequential measurements are captured close in time. If the error terms are
correlated, then the residuals from fitting this kind of data may demonstrate an
phenomenon known as <em>tracking</em>, where adjacent residuals may have similar values. In
these cases, linear regression may not be the right choice.</p>
</div>
<div id="ch4-non-constant-variance-of-error" class="section level4 hasAnchor" number="4.7.5.3">
<h4><span class="header-section-number">4.7.5.3</span> Non-constant variance of error terms<a href="chapter-4.html#ch4-non-constant-variance-of-error" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Linear regression models assume that the error terms have constant <em>variance</em>, that is,
they fall within the same distribution and limits for each response measurement. A
non-constant variance could be expressed if the error ranges become larger at larger
response values, for example. This is called <em>heteroscedasticity</em>. It can be observed in
residual plots as well, often as a “funnel” shape. It can be corrected by applying a
“concave” transformation to one or more predictors, such as <span class="math inline">\(\log{X}\)</span> or <span class="math inline">\(\sqrt{X}\)</span>.
Another option, especially if you have a good idea as to the variance for each response,
is to use observation weights, with weights proportional to the inverse variance.</p>
</div>
<div id="ch4-outliers" class="section level4 hasAnchor" number="4.7.5.4">
<h4><span class="header-section-number">4.7.5.4</span> Outliers<a href="chapter-4.html#ch4-outliers" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><a href="chapter-3.html#ch3-outliers">Just as described for Simple Linear Regression</a></p>
</div>
<div id="ch4-high-leverage-points" class="section level4 hasAnchor" number="4.7.5.5">
<h4><span class="header-section-number">4.7.5.5</span> High-leverage points<a href="chapter-4.html#ch4-high-leverage-points" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><a href="chapter-3.html#ch3-high-leverage-points">Just as described for Simple Linear Regression</a></p>
</div>
<div id="ch4-collinearity" class="section level4 hasAnchor" number="4.7.5.6">
<h4><span class="header-section-number">4.7.5.6</span> Collinearity<a href="chapter-4.html#ch4-collinearity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>When two (or more) predictor variables are highly correlated, they are said to be
<em>collinear</em>. This can reduce the accuracy of the regression coefficients, and can even
result in a failure to reject the null hypothesis in significant cases. This can be
detected by calculating the <em>variance inflation factor</em> (VIF) for each predictor
variable. A value that exceeds 5 or 10 can indicate a problem. When predictors have been
identified as collinear, the situation can be remedied by either (a) dropping all but
one of the predictors or (b) combining the collinear variables into a single predictor
(by taking the average or multiplying them together).</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/chapters/ch04-multiple-linear-regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
