<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 The Tidymodels Workflow | Machine Learning with TidyModels</title>
  <meta name="description" content="This is a primer on various ML modeling techniques and the tidymodels</code>
syntax and workflow for leveraging these techniques.</p>" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 The Tidymodels Workflow | Machine Learning with TidyModels" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a primer on various ML modeling techniques and the tidymodels</code>
syntax and workflow for leveraging these techniques.</p>" />
  <meta name="github-repo" content="ericwburden/machine-learning-with-tidymodels" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 The Tidymodels Workflow | Machine Learning with TidyModels" />
  
  <meta name="twitter:description" content="This is a primer on various ML modeling techniques and the tidymodels</code>
syntax and workflow for leveraging these techniques.</p>" />
  

<meta name="author" content="Eric Burden" />


<meta name="date" content="2022-10-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="simple-linear-regression.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes on Tidymodels</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#software-used"><i class="fa fa-check"></i><b>1.1</b> Software Used</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-tidymodels-workflow.html"><a href="the-tidymodels-workflow.html"><i class="fa fa-check"></i><b>2</b> The Tidymodels Workflow</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-tidymodels-workflow.html"><a href="the-tidymodels-workflow.html#about-tidymodels"><i class="fa fa-check"></i><b>2.1</b> About Tidymodels</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="the-tidymodels-workflow.html"><a href="the-tidymodels-workflow.html#re-use-existing-data-structures"><i class="fa fa-check"></i><b>2.1.1</b> Re-use existing data structures</a></li>
<li class="chapter" data-level="2.1.2" data-path="the-tidymodels-workflow.html"><a href="the-tidymodels-workflow.html#compose-simple-functions-with-pipes"><i class="fa fa-check"></i><b>2.1.2</b> Compose simple functions with pipes</a></li>
<li class="chapter" data-level="2.1.3" data-path="the-tidymodels-workflow.html"><a href="the-tidymodels-workflow.html#embrace-functional-programming"><i class="fa fa-check"></i><b>2.1.3</b> Embrace functional programming</a></li>
<li class="chapter" data-level="2.1.4" data-path="the-tidymodels-workflow.html"><a href="the-tidymodels-workflow.html#design-for-humans"><i class="fa fa-check"></i><b>2.1.4</b> Design for humans</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="the-tidymodels-workflow.html"><a href="the-tidymodels-workflow.html#philosophy-in-practice"><i class="fa fa-check"></i><b>2.2</b> Philosophy in Practice</a></li>
<li class="chapter" data-level="2.3" data-path="the-tidymodels-workflow.html"><a href="the-tidymodels-workflow.html#workflow-steps"><i class="fa fa-check"></i><b>2.3</b> Workflow Steps</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="the-tidymodels-workflow.html"><a href="the-tidymodels-workflow.html#data-splitting"><i class="fa fa-check"></i><b>2.3.1</b> Data Splitting</a></li>
<li class="chapter" data-level="2.3.2" data-path="the-tidymodels-workflow.html"><a href="the-tidymodels-workflow.html#data-preparation"><i class="fa fa-check"></i><b>2.3.2</b> Data Preparation</a></li>
<li class="chapter" data-level="2.3.3" data-path="the-tidymodels-workflow.html"><a href="the-tidymodels-workflow.html#model-specification"><i class="fa fa-check"></i><b>2.3.3</b> Model Specification</a></li>
<li class="chapter" data-level="2.3.4" data-path="the-tidymodels-workflow.html"><a href="the-tidymodels-workflow.html#bundling-a-workflow"><i class="fa fa-check"></i><b>2.3.4</b> Bundling a Workflow</a></li>
<li class="chapter" data-level="2.3.5" data-path="the-tidymodels-workflow.html"><a href="the-tidymodels-workflow.html#checking-results"><i class="fa fa-check"></i><b>2.3.5</b> Checking Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>3</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#description"><i class="fa fa-check"></i><b>3.1</b> Description</a></li>
<li class="chapter" data-level="3.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#how-it-works"><i class="fa fa-check"></i><b>3.2</b> How it Works</a></li>
<li class="chapter" data-level="3.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#evaluating-validity"><i class="fa fa-check"></i><b>3.3</b> Evaluating Validity</a></li>
<li class="chapter" data-level="3.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#evaluating-fit"><i class="fa fa-check"></i><b>3.4</b> Evaluating Fit</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#residual-standard-error"><i class="fa fa-check"></i><b>3.4.1</b> Residual Standard Error</a></li>
<li class="chapter" data-level="3.4.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#r2-statistic"><i class="fa fa-check"></i><b>3.4.2</b> <span class="math inline">\(R^2\)</span> Statistic</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#example"><i class="fa fa-check"></i><b>3.5</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>4</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Machine Learning with TidyModels</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-tidymodels-workflow" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> The Tidymodels Workflow<a href="the-tidymodels-workflow.html#the-tidymodels-workflow" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="about-tidymodels" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> About Tidymodels<a href="the-tidymodels-workflow.html#about-tidymodels" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>tidymodels</code> is an R meta-package, meaning it is essentially a bundle of R packages
organized around a common theme. In this case, the theme is “modeling and machine
learning using <code>tidyverse</code> principles”. In order to make sense of that, one needs to
have a general understanding of what the <code>tidyverse</code> is and its philosophy. The
<code>tidyverse</code> is yet another R meta-package organized around the theme of “data science”.
The <code>tidyverse</code> packages share a common design philosophy, grammar, and many underlying
data structures, such that working with <code>tidyverse</code> packages <em>feels</em> to the user as if
they are leveraging a single, wide-ranging library by a single author (in the best
case). There is an entire book on the subject of using the <code>tidyverse</code> to perform common
data science tasks<span class="citation">(<a href="#ref-wickham_grolemund_2017" role="doc-biblioref">Wickham and Grolemund 2017</a>)</span>, but for the purposes of this book, it is
enough to understand the four principles upon which the <code>tidyverse</code> is built, that
is<span class="citation">(<a href="#ref-wickham2022" role="doc-biblioref">Wickham 2022</a>)</span>:</p>
<ul>
<li>Re-use existing data structures</li>
<li>Compose simple functions with the pipe</li>
<li>Embrace functional programming</li>
<li>Design for humans</li>
</ul>
<div id="re-use-existing-data-structures" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Re-use existing data structures<a href="the-tidymodels-workflow.html#re-use-existing-data-structures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Where possible, <code>tidyverse</code> and, by extension, <code>tidymodels</code> packages rely on common data
structures, typically a <code>tibble</code> or <code>data.frame</code> (a <code>tibble</code> is essentially an improved
<code>data.frame</code> with much of the same API). For more focused operations on single data
types, this is more often a standard R vector or an S3 object that shares the vector
API. In short, data structures produced and consumed by <code>tidyverse</code> and <code>tidymodels</code>
packages should behave as expected by someone who is familiar with base-R data
structures. Data frames should be “tidy”, consisting of variables in columns and
observations in rows<span class="citation">(<a href="#ref-JSSv059i10" role="doc-biblioref">Wickham 2014</a>)</span>.</p>
</div>
<div id="compose-simple-functions-with-pipes" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Compose simple functions with pipes<a href="the-tidymodels-workflow.html#compose-simple-functions-with-pipes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>magrittr</code> library<span class="citation">(<a href="#ref-magrittr" role="doc-biblioref">Bache and Wickham 2022</a>)</span> has long provided a “pipe” (<code>%&gt;%</code>) operator in R. More
recently, a pipe operator (<code>|&gt;</code>) has been introduced to the language itself. There are
some subtle differences in usage between the two, but that is beyond the scope of this
work. In an effort to be as forward-looking as possible, examples in this book will use
the native pipe operator. Regardless of which operator is chosen, however, the effect is
similar to the pipe operator (<code>|</code>) that many will be familiar with from the Unix shell,
in that the pipe serves as an infix operator that takes the result of calling the
left-hand side and passes that result as the first argument to the operation (usually a
function call) on the right-hand side. This makes the examples below equivalent:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="the-tidymodels-workflow.html#cb1-1" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">unlist</span>(<span class="fu">strsplit</span>(<span class="st">&quot;Replace:colons:with:spaces&quot;</span>, <span class="st">&quot;:&quot;</span>)), <span class="at">collapse =</span> <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="the-tidymodels-workflow.html#cb2-1" aria-hidden="true" tabindex="-1"></a>input_str <span class="ot">&lt;-</span> <span class="st">&quot;Replace:colons:with:spaces&quot;</span></span>
<span id="cb2-2"><a href="the-tidymodels-workflow.html#cb2-2" aria-hidden="true" tabindex="-1"></a>split_input <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(input_str, <span class="st">&quot;:&quot;</span>) </span>
<span id="cb2-3"><a href="the-tidymodels-workflow.html#cb2-3" aria-hidden="true" tabindex="-1"></a>split_input_vec <span class="ot">&lt;-</span> <span class="fu">unlist</span>(split_input) </span>
<span id="cb2-4"><a href="the-tidymodels-workflow.html#cb2-4" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">paste</span>(split_input_vec, <span class="at">collapse =</span> <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="the-tidymodels-workflow.html#cb3-1" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="st">&quot;Replace:colons:with:spaces&quot;</span> <span class="sc">|&gt;</span> <span class="fu">strsplit</span>(<span class="st">&quot;:&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">unlist</span>() <span class="sc">|&gt;</span> <span class="fu">paste</span>(<span class="at">collapse =</span> <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="the-tidymodels-workflow.html#cb4-1" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> </span>
<span id="cb4-2"><a href="the-tidymodels-workflow.html#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Replace:colons:with:spaces&quot;</span> <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="the-tidymodels-workflow.html#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">strsplit</span>(<span class="st">&quot;:&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-4"><a href="the-tidymodels-workflow.html#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>() <span class="sc">|&gt;</span> </span>
<span id="cb4-5"><a href="the-tidymodels-workflow.html#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="at">collapse =</span> <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="the-tidymodels-workflow.html#cb5-1" aria-hidden="true" tabindex="-1"></a>(output </span>
<span id="cb5-2"><a href="the-tidymodels-workflow.html#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="ot">&lt;-</span> <span class="st">&quot;Replace:colons:with:spaces&quot;</span> </span>
<span id="cb5-3"><a href="the-tidymodels-workflow.html#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">strsplit</span>(<span class="st">&quot;:&quot;</span>) </span>
<span id="cb5-4"><a href="the-tidymodels-workflow.html#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">unlist</span>() </span>
<span id="cb5-5"><a href="the-tidymodels-workflow.html#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">paste</span>(<span class="at">collapse =</span> <span class="st">&quot; &quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;Replace colons with spaces&quot;</code></pre>
<p>The first and most obvious benefit of this approach is readability. Using the pipe
syntax, operations can be written in the order they are performed, as opposed to the
“inside-out” approach of the first example. We can also avoid cluttering up the R
environment with as in the “intermediate variables” approach of the second example. Less
obvious are the benefits to coding habits; effective use of the pipe operator encourages
sensible function naming and organization. The trade-off is that the programmer needs to
be careful not to take multiple piped operations <em>too</em> far, breaking up long series of
pipes with <em>some</em> intermediate variables as appropriate.</p>
</div>
<div id="embrace-functional-programming" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Embrace functional programming<a href="the-tidymodels-workflow.html#embrace-functional-programming" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There’s a lot to say about what functional programming actually <em>is</em>, but in this
context it mostly means: immutable objects and copy-on-modify semantics, the frequent
use of “pure” functions that do not have side-effects, using generic functions where
possible and appropriate, and abstracting over loops in a more “iterator-like” fashion.</p>
</div>
<div id="design-for-humans" class="section level3 hasAnchor" number="2.1.4">
<h3><span class="header-section-number">2.1.4</span> Design for humans<a href="the-tidymodels-workflow.html#design-for-humans" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is a bit subjective, but the <code>tidyverse</code> and <code>tidymodels</code> strive to provide APIs
that are <em>intuitive</em> for human users and friendly to the IDE such that autocomplete is a
helpful tool for discovering functionality. Generally, being autocomplete-friendly means
grouping function names under common prefixes like [<code>str_subset</code>, <code>str_detect</code>,
<code>str_extract</code>]and [<code>add_model</code>, <code>add_recipe</code>, <code>add_formula</code>] as opposed to alternatives
like [<code>subset_str</code>, <code>detect_str</code>, <code>extract_str</code>] and [<code>model_add</code>, <code>recipe_add</code>,
<code>forumal_add</code>]or the like.</p>
</div>
</div>
<div id="philosophy-in-practice" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Philosophy in Practice<a href="the-tidymodels-workflow.html#philosophy-in-practice" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>These pieces of <code>tidyverse</code> philosophy adopted by <code>tidymodels</code> yield a common way of
working with and thinking about code written using the <code>tidymodels</code> collection of
packages. The most prominent example of this is the <code>tidymodels</code> workflow, or, rather,
the <code>workflow</code> package which is bundled into <code>tidymodels</code>. Throughout this book, the
term <em>workflow object</em> will be used to refer to an R object to which various
pre-processing, modeling, and post-processing steps can be added to facilitate
repeatable and ergonomic ML code. Commonly, this will consist of splitting the data
(using the <code>rsample</code> package), creating and adding a <em>recipe</em> (from the <code>recipes</code>
package), creating and adding a <em>model</em> (from the <code>parsnip</code> package), fitting the model,
then using the model to make inferences or predictions. The <em>recipe</em> and <em>model</em> steps
may be fairly dense as well, but every step along the way should ideally reflect the
principles described above. This approach can be better demonstrated than described, as
show below:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="the-tidymodels-workflow.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into testing and training steps</span></span>
<span id="cb7-2"><a href="the-tidymodels-workflow.html#cb7-2" aria-hidden="true" tabindex="-1"></a>mtcars_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(mtcars)</span>
<span id="cb7-3"><a href="the-tidymodels-workflow.html#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="the-tidymodels-workflow.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-process the data using a recipe</span></span>
<span id="cb7-5"><a href="the-tidymodels-workflow.html#cb7-5" aria-hidden="true" tabindex="-1"></a>(example_recipe</span>
<span id="cb7-6"><a href="the-tidymodels-workflow.html#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="ot">&lt;-</span> <span class="fu">recipe</span>(mpg <span class="sc">~</span> cyl <span class="sc">+</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt, </span>
<span id="cb7-7"><a href="the-tidymodels-workflow.html#cb7-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> <span class="fu">training</span>(mtcars_split))</span>
<span id="cb7-8"><a href="the-tidymodels-workflow.html#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">step_mutate_at</span>(cyl, <span class="at">fn =</span> factor)</span>
<span id="cb7-9"><a href="the-tidymodels-workflow.html#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">step_log</span>(disp, hp)</span>
<span id="cb7-10"><a href="the-tidymodels-workflow.html#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">step_interact</span>(<span class="at">terms =</span> <span class="sc">~</span> disp<span class="sc">:</span>hp))</span></code></pre></div>
<pre><code>## Recipe
## 
## Inputs:
## 
##       role #variables
##    outcome          1
##  predictor          4
## 
## Operations:
## 
## Variable mutation for cyl
## Log transformation on disp, hp
## Interactions with disp:hp</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="the-tidymodels-workflow.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup up the model</span></span>
<span id="cb9-2"><a href="the-tidymodels-workflow.html#cb9-2" aria-hidden="true" tabindex="-1"></a>(example_model</span>
<span id="cb9-3"><a href="the-tidymodels-workflow.html#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>()</span>
<span id="cb9-4"><a href="the-tidymodels-workflow.html#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>)</span>
<span id="cb9-5"><a href="the-tidymodels-workflow.html#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>))</span></code></pre></div>
<pre><code>## Linear Regression Model Specification (regression)
## 
## Computational engine: glm</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="the-tidymodels-workflow.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bundle the recipe and model into a workflow, fit the model</span></span>
<span id="cb11-2"><a href="the-tidymodels-workflow.html#cb11-2" aria-hidden="true" tabindex="-1"></a>(example_workflow</span>
<span id="cb11-3"><a href="the-tidymodels-workflow.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="ot">&lt;-</span> <span class="fu">workflow</span>()</span>
<span id="cb11-4"><a href="the-tidymodels-workflow.html#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">add_recipe</span>(example_recipe)</span>
<span id="cb11-5"><a href="the-tidymodels-workflow.html#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">add_model</span>(example_model)</span>
<span id="cb11-6"><a href="the-tidymodels-workflow.html#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">fit</span>(<span class="at">data =</span> <span class="fu">training</span>(mtcars_split)))</span></code></pre></div>
<pre><code>## ══ Workflow [trained] ═══════════════════════════════════════════════════════════════════════════════
## Preprocessor: Recipe
## Model: linear_reg()
## 
## ── Preprocessor ─────────────────────────────────────────────────────────────────────────────────────
## 3 Recipe Steps
## 
## • step_mutate_at()
## • step_log()
## • step_interact()
## 
## ── Model ────────────────────────────────────────────────────────────────────────────────────────────
## 
## Call:  stats::glm(formula = ..y ~ ., family = stats::gaussian, data = data)
## 
## Coefficients:
## (Intercept)         cyl6         cyl8         disp           hp           wt    disp_x_hp  
##     196.895        1.868        1.300      -29.082      -31.105       -1.404        5.073  
## 
## Degrees of Freedom: 23 Total (i.e. Null);  17 Residual
## Null Deviance:       906.9 
## Residual Deviance: 72.73     AIC: 110.7</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="the-tidymodels-workflow.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add predictions to training data</span></span>
<span id="cb13-2"><a href="the-tidymodels-workflow.html#cb13-2" aria-hidden="true" tabindex="-1"></a>example_predictions <span class="ot">&lt;-</span> <span class="fu">augment</span>(example_workflow, <span class="fu">testing</span>(mtcars_split))</span>
<span id="cb13-3"><a href="the-tidymodels-workflow.html#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="the-tidymodels-workflow.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check performance</span></span>
<span id="cb13-5"><a href="the-tidymodels-workflow.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(example_predictions, mpg, .pred)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 rmse    standard       2.98 
## 2 rsq     standard       0.712
## 3 mae     standard       2.49</code></pre>
<p>To the untrained eye, it may appear that all the functions used in this code are from a
common library, given the similarity in their usage and the ease with which the outputs
of one operation are passed along to the next, but there are actually at least five
different R libraries at play here! This is a key benefit of <code>tidymodels</code>, the bundled
packages work seamlessly together to provide a consistent developer experience.</p>
</div>
<div id="workflow-steps" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Workflow Steps<a href="the-tidymodels-workflow.html#workflow-steps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The typical steps involved in using <code>tidymodels</code> to train and work with ML models are
described below. These steps may be undertaken in a different order than listed here and
individual steps may not be as cleanly separated as indicated. There may be additional
steps for training and testing multiple models or other complex tasks, but the following
is a good, general guide.</p>
<div id="data-splitting" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Data Splitting<a href="the-tidymodels-workflow.html#data-splitting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the first step, you’ll primary use the <code>rsample</code> <span class="citation">(<a href="#ref-rsample" role="doc-biblioref">Silge et al. 2022</a>)</span> package to divide up the
data for training, validating, and testing the model. At a minimum, this generally
involves splitting the data set into <em>training</em> and <em>testing</em> samples. Models, sometimes
many different models, can be trained on the <em>training</em> sample, but the <em>testing</em> sample
should be used only once, to validate and measure model performance on “real” data at
the end. You can also set up your data for re-sampling in this step.</p>
</div>
<div id="data-preparation" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Data Preparation<a href="the-tidymodels-workflow.html#data-preparation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The next step consists of creating a specification for data pre-processing using the
<code>recipes</code> <span class="citation">(<a href="#ref-recipes" role="doc-biblioref">Kuhn and Wickham 2022</a>)</span> package. This can include a number of steps, including specifying
the relationships between the response and predictor variables, data cleaning,
transforming predictors, etc.</p>
</div>
<div id="model-specification" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Model Specification<a href="the-tidymodels-workflow.html#model-specification" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this step, the <code>parsnip</code> <span class="citation">(<a href="#ref-parsnip" role="doc-biblioref">Kuhn and Vaughan 2022</a>)</span> package is typically used to create a model
specification. This includes indicating the type of the model, the model engine, the
model mode, and providing relevant parameters.</p>
</div>
<div id="bundling-a-workflow" class="section level3 hasAnchor" number="2.3.4">
<h3><span class="header-section-number">2.3.4</span> Bundling a Workflow<a href="the-tidymodels-workflow.html#bundling-a-workflow" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This step utilizes the <code>workflows</code> <span class="citation">(<a href="#ref-workflows" role="doc-biblioref">Vaughan and Couch 2022</a>)</span> package to bundle together the recipe
and model specifications into a single <em>workflow object</em>, which can then be used to fit
the model, make predictions, or other operations.</p>
</div>
<div id="checking-results" class="section level3 hasAnchor" number="2.3.5">
<h3><span class="header-section-number">2.3.5</span> Checking Results<a href="the-tidymodels-workflow.html#checking-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this step, the <code>yardstick</code> <span class="citation">(<a href="#ref-yardstick" role="doc-biblioref">Kuhn, Vaughan, and Hvitfeldt 2022</a>)</span> package is used to measure model performance.</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-magrittr" class="csl-entry">
Bache, Stefan Milton, and Hadley Wickham. 2022. <span>“Magrittr: A Forward-Pipe Operator for r.”</span> <a href="https://CRAN.R-project.org/package=magrittr">https://CRAN.R-project.org/package=magrittr</a>.
</div>
<div id="ref-parsnip" class="csl-entry">
Kuhn, Max, and Davis Vaughan. 2022. <span>“Parsnip: A Common API to Modeling and Analysis Functions.”</span> <a href="https://CRAN.R-project.org/package=parsnip">https://CRAN.R-project.org/package=parsnip</a>.
</div>
<div id="ref-yardstick" class="csl-entry">
Kuhn, Max, Davis Vaughan, and Emil Hvitfeldt. 2022. <span>“Yardstick: Tidy Characterizations of Model Performance.”</span> <a href="https://CRAN.R-project.org/package=yardstick">https://CRAN.R-project.org/package=yardstick</a>.
</div>
<div id="ref-recipes" class="csl-entry">
Kuhn, Max, and Hadley Wickham. 2022. <span>“Recipes: Preprocessing and Feature Engineering Steps for Modeling.”</span> <a href="https://CRAN.R-project.org/package=recipes">https://CRAN.R-project.org/package=recipes</a>.
</div>
<div id="ref-rsample" class="csl-entry">
Silge, Julia, Fanny Chow, Max Kuhn, and Hadley Wickham. 2022. <span>“Rsample: General Resampling Infrastructure.”</span> <a href="https://CRAN.R-project.org/package=rsample">https://CRAN.R-project.org/package=rsample</a>.
</div>
<div id="ref-workflows" class="csl-entry">
Vaughan, Davis, and Simon Couch. 2022. <span>“Workflows: Modeling Workflows.”</span> <a href="https://CRAN.R-project.org/package=workflows">https://CRAN.R-project.org/package=workflows</a>.
</div>
<div id="ref-JSSv059i10" class="csl-entry">
Wickham, Hadley. 2014. <span>“Tidy Data.”</span> <em>Journal of Statistical Software</em> 59 (10): 1–23. <a href="https://doi.org/10.18637/jss.v059.i10">https://doi.org/10.18637/jss.v059.i10</a>.
</div>
<div id="ref-wickham2022" class="csl-entry">
———. 2022. <span>“The Tidy Tools Manifesto.”</span> <em>Tidyverse.tidyverse.org</em>, October. <a href="https://tidyverse.tidyverse.org/articles/manifesto.html">https://tidyverse.tidyverse.org/articles/manifesto.html</a>.
</div>
<div id="ref-wickham_grolemund_2017" class="csl-entry">
Wickham, Hadley, and Garrett Grolemund. 2017. <em>R for Data Science</em>. O’Reilly.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simple-linear-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/chapters/01-the-tidymodels-workflow.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
